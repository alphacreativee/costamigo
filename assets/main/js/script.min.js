import{preloadImages}from"../../libs/utils.js";let lenis;function togglePlayMusic(){let t=$("header .btn-music"),r=$("#player")[0];r?t.on("click",function(e){e.preventDefault(),t.toggleClass("pause");try{r.paused?(r.muted=!1,r.play().catch(e=>{console.error("Lỗi phát nhạc:",e)})):r.pause()}catch(e){console.error("Lỗi điều khiển âm thanh:",e)}}):console.error("Không tìm thấy phần tử audio")}function sectionSlider(){$(".section-slider").length<1||document.querySelectorAll(".tab-content .tab-pane").forEach(e=>{var t=e.querySelector(".slider-swiper-content");let s=e.querySelector(".main-slider");var r=e.querySelector(".swiper-pagination");let c=e.querySelector(".swiper-btn-custom"),o=new Swiper(t,{loop:!1,effect:"fade",allowTouchMove:!1});new Swiper(s,{effect:"fade",loop:!0,navigation:{nextEl:c,prevEl:c},pagination:{el:r,clickable:!0,type:"fraction"},on:{slideChange:function(){var e=this.realIndex;o.slideTo(e)}}});s.addEventListener("mousemove",e=>{var t=s.getBoundingClientRect(),r=e.clientX-t.left,e=e.clientY-t.top,o=t.width/2,a=c.offsetWidth,i=c.offsetHeight;c.style.opacity="1";let n=r-a/2;e-=i/2;let l;n=r<=o-50?(l=180,Math.max(0,Math.min(o-a,n))):50+o<=r?(l=0,Math.max(o,Math.min(t.width-a,n))):(l=180-180*((r-(o-50))/100),Math.max(0,Math.min(t.width-a,n))),e=Math.max(0,Math.min(t.height-i,e)),c.style.left=n+"px",c.style.top=e+"px",c.style.transform=`rotate(${l}deg)`}),s.addEventListener("mouseleave",()=>{c.style.opacity="0"})})}function imgWithText(){$(".image-with-text").length<1||(gsap.registerPlugin(ScrollTrigger),$(".image-with-text").each(function(){var e=this;gsap.to($(e).find(".mask.top"),{y:"-100%",duration:1.5,ease:"power2.out",scrollTrigger:{trigger:e,start:"top 80px",toggleActions:"play none none none"}}),gsap.to($(e).find(".mask.bottom"),{y:"100%",duration:1.5,ease:"power2.out",scrollTrigger:{trigger:e,start:"top 80px",toggleActions:"play none none none"}})}))}function animationMaskCentral(){document.querySelectorAll(".animation-image").forEach(e=>{gsap.to(e,{scrollTrigger:{trigger:e,start:"top 50%",end:"bottom 50%",onEnter:()=>e.classList.add("show")}})})}function animationText(){var e=document.querySelectorAll("[data-splitting][data-effect-one]"),t=document.querySelectorAll("[data-splitting][data-effect-two]");e.forEach(e=>{let t=e.querySelectorAll(".char"),r=window.getComputedStyle(t[0]).color||"black";var o=getComputedStyle(e).getPropertyValue("--hover-color")||"red";let a=gsap.timeline({paused:!0}).to(t,{color:o,stagger:.05,duration:.2});e.addEventListener("mouseenter",()=>{a.restart()}),e.addEventListener("mouseleave",()=>{gsap.to(t,{color:r,stagger:.05,duration:.2})})}),t.forEach(e=>{var t=e.querySelectorAll(".char");gsap.fromTo(t,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,stagger:.05,scrollTrigger:{trigger:e,start:"top 60%",end:"bottom 60%"}})}),gsap.utils.toArray("[data-fade-in]").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{scrollTrigger:{trigger:e,start:"top 70%",end:"bottom 70%"},opacity:1,y:0,duration:.5,ease:"sine.out",stagger:.1})}),document.querySelectorAll("[data-fade-desc]").forEach((r,e)=>{new SplitType(r,{types:"lines, words",lineClass:"split-line",wordClass:"split-word"}).lines.forEach((e,t)=>{gsap.from(e.querySelectorAll(".split-word"),{y:"100%",duration:.5,ease:"power2.out",delay:.1*t,scrollTrigger:{trigger:r,start:"top center",end:"top center",toggleActions:"play none none none"}})})})}function swiperRestaurant(){if(!(document.querySelector(".swiper-restaurant").length<1)){var o=new Swiper(".swiper-restaurant",{effect:"fade",slidesPerView:"auto",centeredSlides:!0}),e=document.querySelectorAll(".section-restaurant__content--title a");let r=e[0];r&&r.classList.add("active"),e.forEach((e,t)=>{e.addEventListener("mouseover",function(){o.slideTo(t),r&&r.classList.remove("active"),e.classList.add("active"),r=e})})}}function swiperAct(){if(document.querySelector(".act-slider")){let s=document.querySelector(".act-slider .swiper-btn-act"),c=document.querySelector(".act-slider");var r=new Swiper(".act-slider",{slidesPerView:1.45,pagination:{el:".section-act__slider .swiper-pagination",clickable:!0,type:"fraction"}});r.changeLanguageDirection("rtl"),s&&c?(c.addEventListener("mousemove",e=>{var t=c.getBoundingClientRect(),r=e.clientX-t.left,e=e.clientY-t.top,o=t.width/2,a=s.offsetWidth,i=s.offsetHeight;s.style.opacity="1";let n=r-a/2;e-=i/2;let l;n=r<=o?(l=0,Math.max(0,Math.min(o-a,n))):0+o<=r?(l=180,Math.max(o,Math.min(t.width-a,n))):(l=180-180*((r-o)/0),Math.max(0,Math.min(t.width-a,n))),e=Math.max(0,Math.min(t.height-i,e)),s.style.left=n+"px",s.style.top=e+"px",s.style.transform=`rotate(${l}deg)`}),s.addEventListener("click",e=>{var t=c.getBoundingClientRect();e.clientX-t.left<=t.width/2?r.slideNext():r.slidePrev()}),c.addEventListener("mouseleave",()=>{s.style.opacity="0"})):console.error("Không tìm thấy .swiper-btn-act hoặc .act-slider")}}function swiperOffer(){document.querySelector(".swiper-offer")&&new Swiper(".swiper-offer",{slidesPerView:3,spaceBetween:40,navigation:{nextEl:".section-offer__slider .swiper-button-next",prevEl:".section-offer__slider .swiper-button-prev"}})}function animationLineMap(){gsap.registerPlugin(ScrollTrigger);document.querySelector(".svg-container svg");var e=document.querySelector(".svg-container path"),t=e.getTotalLength();gsap.set(e,{strokeDasharray:t}),gsap.fromTo(e,{strokeDashoffset:t},{strokeDashoffset:0,duration:10,ease:"none",scrollTrigger:{trigger:".svg-container",start:"top top",end:"bottom bottom",scrub:1,markers:!0}})}function scrollHeader(){let e=-1*document.querySelector(".header").offsetHeight,t;function r(){t=gsap.from("header",{y:e,paused:!0,duration:.3,ease:"none",trigger:"header"}).progress(1),ScrollTrigger.create({start:"top top",end:99999,onUpdate:e=>{-1===e.direction?t.play():t.reverse()}})}r(),$(window).on("load",r)}Splitting();let init=()=>{gsap.registerPlugin(ScrollTrigger),sectionSlider(),animationMaskCentral(),swiperOffer(),animationText(),imgWithText(),swiperRestaurant(),scrollHeader(),swiperAct()};togglePlayMusic(),preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});