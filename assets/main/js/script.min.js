import{preloadImages}from"../../libs/utils.js";let lenis;function togglePlayMusic(){let t=$("header .btn-music"),o=$("#player")[0];o?t.on("click",function(e){e.preventDefault(),t.toggleClass("pause");try{o.paused?(o.muted=!1,o.play().catch(e=>{console.error("Lỗi phát nhạc:",e)})):o.pause()}catch(e){console.error("Lỗi điều khiển âm thanh:",e)}}):console.error("Không tìm thấy phần tử audio")}function sectionSlider(){$(".section-slider").length<1||document.querySelectorAll(".tab-content .tab-pane").forEach(e=>{var t=e.querySelector(".slider-swiper-content");let l=e.querySelector(".main-slider");var o=e.querySelector(".swiper-pagination");let c=e.querySelector(".swiper-btn-custom"),r=new Swiper(t,{loop:!1,effect:"fade",allowTouchMove:!1});new Swiper(l,{effect:"fade",loop:!0,navigation:{nextEl:c,prevEl:c},pagination:{el:o,clickable:!0,type:"fraction"},on:{slideChange:function(){var e=this.realIndex;r.slideTo(e)}}});l.addEventListener("mousemove",e=>{var t=l.getBoundingClientRect(),o=e.clientX-t.left,e=e.clientY-t.top,r=t.width/2,n=c.offsetWidth,a=c.offsetHeight;c.style.opacity="1",c.style.transform="scale(1)";let i=o-n/2;e-=a/2;let s;i=o<=r-50?(s=180,Math.max(0,Math.min(r-n,i))):50+r<=o?(s=0,Math.max(r,Math.min(t.width-n,i))):(s=180-180*((o-(r-50))/100),Math.max(0,Math.min(t.width-n,i))),e=Math.max(0,Math.min(t.height-a,e)),c.style.left=i+"px",c.style.top=e+"px",c.style.transform=`scale(1) rotate(${s}deg)`}),l.addEventListener("mouseleave",()=>{c.style.opacity="0",c.style.transform="scale(0)"})})}function imgWithText(){$(".image-with-text").length<1||(gsap.registerPlugin(ScrollTrigger),$(".image-with-text").each(function(){gsap.to($(this).find(".content-box "),{yPercent:-10,ease:"none",scrollTrigger:{trigger:$(this).find(".content-box"),start:"top 30%",end:"bottom top",scrub:!0}})}),document.querySelectorAll(".image-with-text").forEach(n=>{var e=n.querySelector(".section-wrapper"),t=n.querySelector(".section-wrapper img");e&&t&&(gsap.fromTo(e,{clipPath:"inset(0% 0% 0% 0%)"},{scrollTrigger:{trigger:n,start:"top 70%",end:"bottom 70%"},clipPath:()=>{var e=window.innerWidth;let t=e-32;var o=(e-(t=991<e||767<e?e-80:e-32))/2/e*100,r=n.offsetHeight,e=(r-(991<e?r-100:r))/2/r*100;return`inset(${e}% ${o}% ${e}% ${o}%)`},duration:1,ease:"power2.out"}),gsap.fromTo(t,{scale:1},{scrollTrigger:{trigger:e,start:"top 70%",end:"bottom 70%"},scale:1.1,duration:1,ease:"power2.out"}))}))}function animationMaskCentral(){if(!($(".image-with-text").length<1)){document.querySelectorAll(".animation-image").forEach(e=>{gsap.to(e,{scrollTrigger:{trigger:e,start:"top 70%",end:"bottom 70%",onEnter:()=>e.classList.add("show")}})});let e=document.querySelectorAll(".animation-image-banner");window.addEventListener("load",()=>{setTimeout(()=>{e.forEach(e=>{e.classList.add("show")})},300)})}}function animationText(){gsap.registerPlugin(ScrollTrigger);var e=document.querySelectorAll("[data-splitting][data-effect-one]"),t=document.querySelectorAll("[data-splitting][data-effect-two]"),o=document.querySelectorAll("[data-splitting][data-effect-three]");e.forEach(e=>{let t=e.querySelectorAll(".char"),o=window.getComputedStyle(t[0]).color||"black";var r=getComputedStyle(e).getPropertyValue("--hover-color")||"red";let n=gsap.timeline({paused:!0}).to(t,{color:r,stagger:.05,duration:.2});e.addEventListener("mouseenter",()=>{n.restart()}),e.addEventListener("mouseleave",()=>{gsap.to(t,{color:o,stagger:.05,duration:.2})})}),t.forEach(e=>{var t=e.querySelectorAll(".char");gsap.fromTo(t,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,stagger:.05,scrollTrigger:{trigger:e,start:"top 60%",end:"bottom 60%"}})}),o.forEach(e=>{var t=e.querySelectorAll(".char");gsap.fromTo(t,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,stagger:.05,scrollTrigger:{trigger:e,start:"top 40%",end:"bottom 40%"}})}),gsap.utils.toArray("[data-fade-in]").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{scrollTrigger:{trigger:e,start:"top 70%",end:"bottom 70%"},opacity:1,y:0,duration:.5,ease:"sine.out",stagger:.1})}),gsap.utils.toArray("[data-fade-in-v2]").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{scrollTrigger:{trigger:e,start:"top 65%",end:"bottom 65%"},opacity:1,y:0,duration:.5,ease:"sine.out",stagger:.1})}),document.querySelectorAll("[data-fade-desc]").forEach((o,e)=>{new SplitType(o,{types:"lines, words",lineClass:"split-line",wordClass:"split-word"}).lines.forEach((e,t)=>{gsap.from(e.querySelectorAll(".split-word"),{y:"100%",duration:.5,ease:"power2.out",delay:.1*t,scrollTrigger:{trigger:o,start:"top center",end:"top center",toggleActions:"play none none none"}})})}),document.querySelectorAll("[data-fade-desc-v2]").forEach((o,e)=>{new SplitType(o,{types:"lines, words",lineClass:"split-line",wordClass:"split-word"}).lines.forEach((e,t)=>{gsap.from(e.querySelectorAll(".split-word"),{y:"100%",duration:.5,ease:"power2.out",delay:.1*t,scrollTrigger:{trigger:o,start:"top 50%",end:"top 50%",toggleActions:"play none none none"}})})})}function swiperRestaurant(){if(document.querySelector(".swiper-restaurant")){var r=new Swiper(".swiper-restaurant",{effect:"fade",slidesPerView:"auto",centeredSlides:!0}),e=document.querySelectorAll(".section-restaurant__content--title a");let o=e[0];o&&o.classList.add("active"),e.forEach((e,t)=>{e.addEventListener("mouseover",function(){r.slideTo(t),o&&o.classList.remove("active"),e.classList.add("active"),o=e})})}}function swiperAct(){if(document.querySelector(".act-slider")){let l=document.querySelector(".act-slider .swiper-btn-act"),c=document.querySelector(".act-slider");document.querySelector(".swiper-act-content");var e=new Swiper(".swiper-act-content",{slidesPerView:1,watchSlidesProgress:!0,watchSlidesVisibility:!0,effect:"fade",fadeEffect:{crossFade:!0},spaceBetween:30,allowTouchMove:!1}),o=new Swiper(".act-slider",{slidesPerView:1.45,speed:1e3,pagination:{el:".section-act__slider .swiper-pagination",clickable:!0,type:"fraction"},thumbs:{swiper:e}});o.changeLanguageDirection("rtl"),l&&c?(c.addEventListener("mousemove",e=>{var t=c.getBoundingClientRect(),o=e.clientX-t.left,e=e.clientY-t.top,r=t.width/2,n=l.offsetWidth,a=l.offsetHeight;l.style.opacity="1",l.style.transform="scale(1)";let i=o-n/2;e-=a/2;let s;i=o<=r?(s=0,Math.max(0,Math.min(r-n,i))):0+r<=o?(s=180,Math.max(r,Math.min(t.width-n,i))):(s=180-180*((o-r)/0),Math.max(0,Math.min(t.width-n,i))),e=Math.max(0,Math.min(t.height-a,e)),l.style.left=i+"px",l.style.top=e+"px",l.style.transform=`scale(1) rotate(${s}deg)`}),l.addEventListener("click",e=>{var t=c.getBoundingClientRect();e.clientX-t.left<=t.width/2?o.slideNext():o.slidePrev()}),c.addEventListener("mouseleave",()=>{l.style.opacity="0",l.style.transform="scale(0)"})):console.error("Không tìm thấy .swiper-btn-act hoặc .act-slider")}}function swiperOffer(){document.querySelector(".swiper-offer")&&new Swiper(".swiper-offer",{slidesPerView:3,spaceBetween:40,navigation:{nextEl:".section-offer__slider .swiper-button-next",prevEl:".section-offer__slider .swiper-button-prev"}})}function animationLineMap(){$("#maskRect").length<1||(gsap.registerPlugin(ScrollTrigger,MotionPathPlugin),gsap.to("#maskRect",{height:5989,ease:"none",scrollTrigger:{trigger:".svg-container",start:"top center",end:"bottom bottom",scrub:!0}}))}function scrollHeader(){ScrollTrigger.refresh(),ScrollTrigger.create({start:"top top",end:99999,paused:!0,onUpdate:e=>{var t=document.querySelector("header");0===window.scrollY&&t.classList.remove("scrolled"),1===e.direction?t.classList.add("scrolled"):t.classList.remove("scrolled"),1===e.direction?$(".cta-group").addClass("hide"):$(".cta-group").removeClass("hide")}})}function animationArt(){document.querySelectorAll(".animation-art").forEach(e=>{gsap.to(e,{yPercent:20,ease:"none",scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:!0}})}),document.querySelectorAll(".animation-art-reverse").forEach(e=>{gsap.to(e,{yPercent:30,ease:"none",scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:!0}})})}function headerMenu(){let e=document.querySelector(".btn-hamburger"),t=document.querySelector(".header-sub-menu"),o=gsap.timeline({paused:!0});var r=document.querySelector(".sub-menu-overlay");o.from(".sub-menu ul li",{opacity:0,y:20,stagger:.1,duration:.3,ease:"power2.out"}),e.addEventListener("click",()=>{t.classList.toggle("show"),e.classList.toggle("change"),t.classList.contains("show")?(o.restart(),document.body.classList.add("overflow-hidden")):(o.reverse(),document.body.classList.remove("overflow-hidden"))}),r.addEventListener("click",()=>{o.reverse(),e.classList.remove("change"),t.classList.remove("show"),document.body.classList.remove("overflow-hidden")})}function toggleDropdown(){let i=jQuery(".dropdown-custom");i.each(function(){let t=jQuery(this);var e=t.find(".dropdown-custom__btn");let o=t.find(".dropdown-custom__menu");var r=t.find(".dropdown-custom__item");let n=t.find(".dropdown-custom__text");function a(t){i.each(function(){var e=jQuery(this).find(".dropdown-custom__menu");t&&jQuery(this).is(t)||e.removeClass("dropdown--active")})}e.on("click",function(e){e.stopPropagation(),a(t),o.toggleClass("dropdown--active");e=e.clientY;jQuery(window).height()/2<e?o.removeClass("dropdown-up"):o.addClass("dropdown-up")}),jQuery(document).on("click",function(){a()}),r.on("click",function(e){e.stopPropagation();var e=jQuery(this),t=n.text();n.text(e.text()),e.hasClass("language__item")&&e.text(t),a()})})}function modalBooking(){if(!($(".modal-booking").length<1)){var t=document.querySelector('[name="booking-startday"]');if(t){let e=new Lightpick({field:t,singleDate:!0,numberOfMonths:1,format:"DD/MM/YYYY",minDate:moment(),onSelect:function(e){try{e?($('[name="booking-startday"]').val(e.format("DD/MM/YYYY")),$(".field.date .field-border-bottom").removeClass("error")):console.warn("start is undefined in onSelect")}catch(e){console.error("Error in Lightpick onSelect:",e)}}});0===$('[name="booking-hour"]').length?console.error('Input field [name="booking-hour"] not found'):($("form").on("submit",function(e){e.preventDefault();let o=!0;$(".error").removeClass("error");[{name:"booking-startday",errorField:".field.date .field-border-bottom"},{name:"booking-adult",errorField:".adult.field-border-bottom"},{name:"booking-name",errorField:".name.field-border-bottom"},{name:"booking-phone",errorField:".phone.field-border-bottom"}].forEach(e=>{var t=$(`[name="${e.name}"]`);t.val()&&""!==t.val().trim()||($(e.errorField).addClass("error"),o=!1)});e=$('[name="booking-phone"]').val();e&&!/^[0-9]{10,11}$/.test(e)&&($(".phone.field-border-bottom").addClass("error"),o=!1),o&&($("#modalBooking").modal("hide"),$("#modalBookingSuccess").modal("show"),this.reset(),$(".error").removeClass("error"))}),$('[name="booking-adult"], [name="booking-name"], [name="booking-phone"]').on("input",function(){var e=$(this).closest(".field-border-bottom");e.hasClass("error")&&e.removeClass("error")}),$('[name="booking-startday"]').on("click",function(){e.show()}))}else console.error('Input field [name="booking-startday"] not found')}}function magicCursor(){if(!($(".magic-cursor").length<1)){var r=document.querySelector(".magic-cursor");gsap.set(r,{xPercent:-50,yPercent:-50});let t,o;window.addEventListener("mousemove",e=>{t=e.clientX,o=e.clientY,gsap.to(r,{x:t,y:o,duration:.1})});var e=document.querySelectorAll(".modal, [data-cursor-text]"),n=document.querySelector(".magic-cursor .cursor"),a=document.querySelector(".magic-cursor .cursor .text");e.forEach(t=>{t.addEventListener("mouseenter",()=>{let e="";e=t.classList.contains("modal")?"Đóng":t.getAttribute("data-cursor-text"),a.innerHTML=`<span class="b2-regular color-white">${e}</span>`,n.classList.add("show-text")}),t.addEventListener("mouseleave",()=>{a.innerHTML="",n.classList.remove("show-text")})}),document.querySelectorAll(".modal-dialog").forEach(e=>{e.addEventListener("mouseenter",()=>{n.classList.remove("show-text")}),e.addEventListener("mouseleave",()=>{a.innerHTML='<span class="b2-regular color-white">Đóng</span>',n.classList.add("show-text")})})}}function detailSlider(){$(".detail-slider").length<1||(new Swiper(".detail-slider",{loop:!1,speed:1500,grabCursor:!0,watchSlidesProgress:!0,mousewheelControl:!0,keyboardControl:!0,autoplay:!1,navigation:{nextEl:document.querySelector(".detail-slider").parentElement.querySelector(".swiper-button-next"),prevEl:document.querySelector(".detail-slider").parentElement.querySelector(".swiper-button-prev")},on:{progress:function(o){o.slides.forEach(function(e){var t=(e.progress||0)*(.9*o.width);isNaN(t)||(e=e.querySelector(".detail-slider__image"))&&(e.style.transform="translate3d("+t+"px, 0, 0)")})},touchStart:function(e){e.slides.forEach(function(e){e.style.transition=""})},setTransition:function(e,t){var o="cubic-bezier(0.25, 0.1, 0.25, 1)";e.slides.forEach(function(e){e.style.transition=t+"ms "+o;e=e.querySelector(".detail-slider__image");e&&(e.style.transition=t+"ms "+o)})}}}),document.querySelectorAll(".detail-slider__arrows .swiper-button-next,.detail-slider__arrows .swiper-button-prev").forEach(r=>{let n=r.querySelector("img");n&&(gsap.set(n,{opacity:0,scale:.8,pointerEvents:"none"}),r.addEventListener("mouseenter",()=>{"true"!==r.getAttribute("disabled")&&gsap.to(n,{opacity:1,scale:1,duration:.3,ease:"power2.out"})}),r.addEventListener("mousemove",e=>{var t,o;"true"!==r.getAttribute("disabled")&&(t=r.getBoundingClientRect(),o=e.clientX-t.left,e=e.clientY-t.top,gsap.to(n,{x:o,y:e,duration:.3,ease:"power3.out"}))}),r.addEventListener("mouseleave",()=>{gsap.to(n,{opacity:0,scale:.8,duration:.3,ease:"power2.out"})}))}))}function loading(){document.querySelector(".loading")&&(document.querySelector(".loading").classList.add("loading-out"),document.body.classList.remove("scroll-hidden"),setTimeout(()=>{document.querySelectorAll(".loading").forEach(e=>{e.style.display="none"})},1500))}function updateSvgHeight(){var e,t=document.querySelector(".svg-container svg"),o=document.querySelector("footer");t?o?(o=document.body.clientHeight-(e=window.innerHeight)-(o.clientHeight-140),console.log(o),0<o?t.setAttribute("height",o):t.setAttribute("height",e)):console.error('Footer element not found. Check if "footer" exists.'):console.error('SVG element not found. Check if ".svg-container svg" exists.')}function gallery(){if(console.log("animated-thumb"),document.querySelector(".animated-thumb")){lightGallery(document.querySelector(".animated-thumb"),{selector:".thumb-img",thumbnail:!0,download:!1,height:"100%",width:"100%",iframeMaxWidth:"100%",subHtmlSelectorRelative:!0});let o=document.querySelector(".lg-prev"),r=document.querySelector(".lg-next"),n=document.querySelector(".lg-container");var e=document.querySelector(".lg-close");let a=!1;n.addEventListener("mousemove",e=>{var t;a||(t=(t=n.getBoundingClientRect()).left+t.width/2,o.style.left=e.clientX+"px",o.style.top=e.clientY+"px",r.style.left=e.clientX+"px",r.style.top=e.clientY+"px",e.clientX<t?(o.style.display="block",r.style.display="none"):(o.style.display="none",r.style.display="block",r.style.transform="scale(1) translate(-200%, -150%)"))}),n.addEventListener("mouseleave",()=>{o.style.display="none",r.style.display="none"}),e.addEventListener("mouseenter",()=>{a=!0,r.style.transform="scale(0) translate(-200%, -150%)"}),e.addEventListener("mouseleave",()=>{a=!1,r.style.transform="scale(1) translate(-200%, -150%)"})}}function fadeTextFooter(){gsap.set("data-text-footer",{opacity:0,y:20});var e=gsap.timeline({paused:!0});e.fromTo("[data-text-footer]",{opacity:0,y:20},{opacity:1,y:0,stagger:.1,duration:.6,ease:"power2.out"}),ScrollTrigger.create({trigger:"footer",start:"top 80%",animation:e,toggleActions:"play none none none"})}Splitting(),($=jQuery)(window).on("DOMContentLoaded",function(){setTimeout(()=>{loading()},2e3)});let init=()=>{gsap.registerPlugin(ScrollTrigger),updateSvgHeight(),fadeTextFooter(),headerMenu(),scrollHeader(),animationArt(),sectionSlider(),animationMaskCentral(),swiperOffer(),animationText(),imgWithText(),swiperRestaurant(),toggleDropdown(),gallery(),animationLineMap(),swiperAct(),magicCursor(),detailSlider(),modalBooking(),ScrollTrigger.refresh()};togglePlayMusic(),window.addEventListener("resize",()=>{animationText()}),preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});